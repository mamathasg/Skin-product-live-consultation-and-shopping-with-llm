<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>GlowCare | Skincare E-Commerce</title>

	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
</head>
<body>

<!-- ğŸŒ¸ NAVBAR -->
<nav class="navbar navbar-expand-lg shadow-sm fixed-top bg-light">
	<div class="container-fluid">
		<a class="navbar-brand fw-bold text-success" href="{{ url_for('home') }}">ğŸŒ¸ GlowCare</a>
		<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
			<span class="navbar-toggler-icon"></span>
		</button>

		<div class="collapse navbar-collapse" id="navbarNav">
			<ul class="navbar-nav me-auto mb-2 mb-lg-0">
				<li class="nav-item">
					<a class="nav-link fw-semibold text-success" href="{{ url_for('home') }}">Home</a>
				</li>

				{% if session.get('user_id') %}
					<li class="nav-item"><a class="nav-link" href="{{ url_for('browse') }}">Shop</a></li>
					<li class="nav-item"><a class="nav-link" href="{{ url_for('consultation') }}">Consultation</a></li>
					<li class="nav-item"><a class="nav-link" href="{{ url_for('my_orders') }}">My Orders</a></li>

				{% elif session.get('derm_id') %}
					<li class="nav-item"><a class="nav-link" href="{{ url_for('derm_dashboard') }}">Dashboard</a></li>
					<li class="nav-item"><a class="nav-link" href="{{ url_for('derm_appointments') }}">Appointments</a></li>
					<li class="nav-item"><a class="nav-link" href="{{ url_for('derm_slots') }}">Availability</a></li>
				{% endif %}
			</ul>

			<ul class="navbar-nav">
				{% if session.get('user_id') %}
					<li class="nav-item">
						<a class="nav-link position-relative" href="{{ url_for('cart') }}">
							ğŸ›’ Cart
							{% if session.get('cart') %}
								<span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-success">
									{{ session.get('cart')|length }}
								</span>
							{% endif %}
						</a>
					</li>
					<li class="nav-item">
						<span class="nav-link fw-semibold">Hi, {{ session.get('user') }} ğŸ‘‹</span>
					</li>
					<li class="nav-item">
						<a class="btn btn-outline-danger ms-2" href="{{ url_for('logout') }}">Logout</a>
					</li>

				{% elif session.get('derm_id') %}
					<li class="nav-item">
						<span class="nav-link fw-semibold text-primary">Hi, {{ session.get('derm_name') }} ğŸ‘©â€âš•ï¸</span>
					</li>
					<li class="nav-item">
						<a class="btn btn-outline-danger ms-2" href="{{ url_for('derm_logout') }}">Logout</a>
					</li>

				{% else %}
					<li class="nav-item"><a class="btn btn-outline-dark me-2" href="{{ url_for('login') }}">Login</a></li>
					<li class="nav-item"><a class="btn btn-primary me-2" href="{{ url_for('signup') }}">Signup</a></li>
					<li class="nav-item"><a class="btn btn-outline-primary" href="{{ url_for('derm_login') }}">Derm Login</a></li>
				{% endif %}
			</ul>
		</div>
	</div>
</nav>

<div class="container mt-5 pt-5">
	{% with messages = get_flashed_messages(with_categories=true) %}
	  {% if messages %}
	    {% for category, message in messages %}
	      <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
	        {{ message | safe }}
	        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
	      </div>
	    {% endfor %}
	  {% endif %}
	{% endwith %}
</div>

<div class="container mt-5 mb-5 pt-4">
	{% block content %}{% endblock %}
</div>

<footer class="text-center mt-5 py-4 border-top">
	<p class="mb-1">Â© 2025 GlowCare â€” Radiance in Every Routine âœ¨</p>
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>

<!-- Floating Chat Button -->
<button id="glowcareChatBtn" class="glowcare-chat-button">ğŸ’¬</button>

<!-- Chat Box -->
<div id="glowcareChatBox" class="glowcare-chat-box">
	<div class="chat-header">
		GlowCare Assistant
		<button id="chatCloseBtn" class="close-btn">Ã—</button>
	</div>

	<div id="chatMessages" class="chat-messages"></div>

	<div class="chat-input-bar">
		<input id="chatInput" type="text" placeholder="Ask me anything..." autocomplete="off">
		<button id="chatSendBtn" class="send-btn">â¤</button>
	</div>
</div>

<!-- ğŸ’¬ Correct Working Chat Script -->
<script>
document.addEventListener("DOMContentLoaded", () => {

    const chatBtn = document.getElementById("glowcareChatBtn");
    const chatBox = document.getElementById("glowcareChatBox");
    const closeBtn = document.getElementById("chatCloseBtn");
    const input = document.getElementById("chatInput");
    const sendBtn = document.getElementById("chatSendBtn");
    const messages = document.getElementById("chatMessages");

    let greeted = false;

    chatBtn.onclick = () => {
        chatBox.style.display = "flex";
        if (!greeted) {
            addAI("Hi! ğŸ‘‹ I'm your GlowCare Assistant. How can I help you today?");
            greeted = true;
        }
    };

    closeBtn.onclick = () => {
        chatBox.style.display = "none";
    };

    function addUser(msg) {
        messages.innerHTML += `<div class='chat-message-user'><span>${msg}</span></div>`;
        messages.scrollTop = messages.scrollHeight;
    }

    function addAI(msg) {
        messages.innerHTML += `<div class='chat-message-ai'><span>${msg}</span></div>`;
        messages.scrollTop = messages.scrollHeight;
    }

    async function send() {
        let q = input.value.trim();
        if (!q) return;

        addUser(q);
        input.value = "";
        addAI("Typing...");

        const res = await fetch("/ask_llm", {
            method: "POST",
            headers: {"Content-Type": "application/json"},
            body: JSON.stringify({question: q})
        });

        const data = await res.json();

        messages.lastElementChild.remove();
        addAI(data.reply);
    }

    sendBtn.onclick = send;

    input.addEventListener("keydown", e => {
        if (e.key === "Enter") send();
    });

});
</script>

</html>
578